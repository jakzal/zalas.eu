---
layout: post
title: Finding files and directories in PHP with Symfony2 Finder component
tags:
- components
- Finder
- php
- Symfony2
status: publish
type: post
published: true
meta:
  _edit_last: '1'
  description: Symfony Finder component makes the task of finding files and directories
    less tedious. It supports filtering by name, pattern, size, date of modification
    and few other criteria. As a result we get objects of class SplFileInfo. It offers
    convenient way of retrieving file and directory details.
  keywords: Symfony,Finder,component,find,files,directories,filter,Symfony2,php
---
<img class="size-thumbnail wp-image-823 alignright" title="Photo by Paul Watson: http://flic.kr/p/9HpBfjt" src="/uploads/wp/2011/07/sieve-150x150.jpg" alt="Photo by Paul Watson: http://flic.kr/p/9HpBfj" width="150" height="150" />Symfony <a title="Finder Component" href="https://github.com/symfony/Finder">Finder component</a> makes the task of finding files and directories less tedious. It supports filtering by name, pattern, size, date of modification and few other criteria. As a result we get objects of class <a title="SplFileInfo on php.net" href="http://php.net/splfileinfo">SplFileInfo</a> which offers convenient way of retrieving file and directory details.

<strong>Note</strong>: Code used in this post is available on github: <a href="https://github.com/jakzal/SymfonyComponentsExamples">https://github.com/jakzal/SymfonyComponentsExamples</a>
<h2>Installation</h2>
You can either install it from the <a title="Symfony PEAR Channel" href="http://pear.symfony.com/">Symfony PEAR channel</a> or grab it <a title="Symfony2 Finder on github" href="https://github.com/symfony/Finder">directly from github</a>. For the purpose of this article we'll clone the sources to the <em>vendor/</em> directory of the project.
<pre>git clone https://github.com/symfony/Finder.git vendor/Symfony/Component/Finder</pre>
We'll let Symfony ClassLoader component to take care of the class autoloading. Read more about it in the "<a title="Autoloading classes in an any PHP project with Symfony2 ClassLoader component" href="http://www.zalas.eu/autoloading-classes-in-any-php-project-with-symfony2-classloader-component">Autoloading classes in an any PHP project with Symfony2 ClassLoader component</a>".

Following code is sufficient to load classes from any Symfony component (assuming components are put into the <em>vendor/Symfony/Component</em> directory):
<pre>&lt;?php
// src/autoload.php
require_once __DIR__.'/../vendor/Symfony/Component/ClassLoader/UniversalClassLoader.php';

$loader = new Symfony\Component\ClassLoader\UniversalClassLoader();
$loader-&gt;registerNamespaces(array(
    'Symfony' =&gt; __DIR__.'/../vendor',
    'PSS'     =&gt; __DIR__
));
$loader-&gt;register();</pre>
<h2>Example usage</h2>
Basically all we'll ever need is to create a Finder object with <em>create()</em> method and use <a title="Fluent Interface" href="http://en.wikipedia.org/wiki/Fluent_interface">fluent interface</a> to define what we're looking for. It's best to review the <a title="Finder class" href="https://github.com/symfony/Finder/blob/master/Finder.php">Finder class</a> for available filtering and sorting methods.

For example, to list all Symfony components installed in <em>vendor/Symfony/Component</em> directory we could write the following script:
<pre>&lt;?php
// finderdir.php
require_once __DIR__.'/src/autoload.php';

use Symfony\Component\Finder as Finder;

$components = Finder\Finder::create()
    -&gt;directories()
    -&gt;depth(0)
    -&gt;in('vendor/Symfony/Component');

echo "Installed Symfony components:\n";
foreach ($components as $dir) {
    printf("* %s \n", $dir-&gt;getFilename());
}</pre>
To show more sophisticated example, here's how we'd search for files matching the <em>/^He.+Command.php$/</em> pattern, which are smaller than <em>4kb</em> and were modified <em>till yesterday</em>. Results will be sorted by <em>file name</em> and we'll look for them in the <em>current directory</em>:
<pre>&lt;?php
// finder.php
require_once __DIR__.'/src/autoload.php';

use Symfony\Component\Finder as Finder;

$files = Finder\Finder::create()
    -&gt;files()
    -&gt;name('/^He.+Command.php$/')
    -&gt;size('&lt;4k')
    -&gt;date('until yesterday')
    -&gt;sortByName()
    -&gt;in('.');

echo "Command files starting with 'He' below 4k modified untill yesterday:\n";
foreach ($files as $file) {
    printf("* %s %s\n", $file-&gt;getFilename(), date('Y-m-d H:i', $file-&gt;getMTime()));
}</pre>
Easy, isn't it?

Finder component gives us a really nice and flexible way to search and than to iterate through files and directories. It's one of those handy libraries which we probably won't use often. Once we need it, however, we may find it a real time saver.
