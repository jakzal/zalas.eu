<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Finding files and directories in PHP with Symfony2 Finder component &mdash; Jakub Zalas &mdash; Agile Software Engineer</title>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="verify-v1" content="PBznb5+bhxbUdD7HvioYYudpqitFdLDgjQTv8SwALq4=" />        <meta name="keywords" content="Symfony,components,finder">
                <meta name="description" content="Symfony&#039;s Finder component makes the task of finding files and directories less tedious">
                    <meta name="robots" content="index, follow">
        <link rel="shortcut icon" href="//zalas.eu/favicon.ico" />
        <link rel="alternate" type="application/atom+xml" href="//zalas.eu/atom.xml" title="Jakub Zalas activity feed" />
        <link href="//zalas.eu/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="//zalas.eu/css/base.css" rel="stylesheet" type="text/css" />
        <link href="//zalas.eu/css/code.css" rel="stylesheet" type="text/css" />
        <link href="//zalas.eu/components/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
                                    </head>
    <body>
        <div class="container">
            <div class="row">
                        <section itemscope itemtype="http://schema.org/BlogPosting">
        <h1 itemprop="name">Finding files and directories in PHP with Symfony2 Finder component</h1>
        <div class="post-date pull-right">
            <time itemprop="datePublished" content="2011-07-07" datetime="2011-07-07">07 Jul 2011</time>
        </div>
        <ul class="list-unstyled list-inline post-tag-cloud">
                        <li>
                <span class="glyphicon glyphicon-tag"></span>
                <a href="//zalas.eu/tag/components/">
                    <span class="list-group-item-heading">components</span>
                </a>
            </li>
                        <li>
                <span class="glyphicon glyphicon-tag"></span>
                <a href="//zalas.eu/tag/Finder/">
                    <span class="list-group-item-heading">Finder</span>
                </a>
            </li>
                        <li>
                <span class="glyphicon glyphicon-tag"></span>
                <a href="//zalas.eu/tag/php/">
                    <span class="list-group-item-heading">php</span>
                </a>
            </li>
                        <li>
                <span class="glyphicon glyphicon-tag"></span>
                <a href="//zalas.eu/tag/Symfony2/">
                    <span class="list-group-item-heading">Symfony2</span>
                </a>
            </li>
                    </ul>

                <div class="alert alert-danger">
            <strong>Warning</strong>: This blog post was written a long time ago and might be no longer relevant.
        </div>
        
        <section class="content" itemprop="articleBody"><div class="pull-right">
    <img src="/uploads/wp/2011/07/sieve-150x150.jpg" title="Photo by Paul Watson: http://flic.kr/p/9HpBfj" alt="Photo by Paul Watson: http://flic.kr/p/9HpBfj" class="img-responsive" />
</div>

<p>Symfony <a href="https://github.com/symfony/Finder">Finder component</a> makes the task of finding files and directories less tedious. It supports filtering by name, pattern, size, date of modification and few other criteria. As a result we get objects of class <a href="http://php.net/splfileinfo">SplFileInfo</a> which offers convenient way of retrieving file and directory details.</p>

<div class="alert alert-warning">

<p><strong>Note</strong>: Code used in this post is available on github: <a href="https://github.com/jakzal/SymfonyComponentsExamples">https://github.com/jakzal/SymfonyComponentsExamples</a></p>

</div>

<h2 id="installation">Installation</h2>

<p>You can either install it from the <a href="http://pear.symfony.com/">Symfony PEAR channel</a> or grab it <a href="https://github.com/symfony/Finder">directly from github</a>. For the purpose of this article we'll clone the sources to the <em>vendor/</em> directory of the project.</p>

<pre><code class="bash">git clone https://github.com/symfony/Finder.git vendor/Symfony/Component/Finder
</code></pre>

<p>We'll let Symfony ClassLoader component to take care of the class autoloading. Read more about it in the "<a href="//zalas.eu/autoloading-classes-in-any-php-project-with-symfony2-classloader-component/">Autoloading classes in an any PHP project with Symfony2 ClassLoader component</a>".</p>

<p>Following code is sufficient to load classes from any Symfony component (assuming components are put into the <em>vendor/Symfony/Component</em> directory):</p>

<pre><code class="php">&lt;?php
// src/autoload.php
require_once __DIR__.'/../vendor/Symfony/Component/ClassLoader/UniversalClassLoader.php';

$loader = new Symfony\Component\ClassLoader\UniversalClassLoader();
$loader-&gt;registerNamespaces(array(
    'Symfony' =&gt; __DIR__.'/../vendor',
    'PSS'     =&gt; __DIR__
));
$loader-&gt;register();
</code></pre>

<h2 id="example-usage">Example usage</h2>

<p>Basically all we'll ever need is to create a Finder object with <em>create()</em> method and use <a href="http://en.wikipedia.org/wiki/Fluent_interface">fluent interface</a> to define what we're looking for. It's best to review the <a href="https://github.com/symfony/Finder/blob/master/Finder.php">Finder class</a> for available filtering and sorting methods.</p>

<p>For example, to list all Symfony components installed in <em>vendor/Symfony/Component</em> directory we could write the following script:</p>

<pre><code class="php">&lt;?php
// finderdir.php
require_once __DIR__.'/src/autoload.php';

use Symfony\Component\Finder as Finder;

$components = Finder\Finder::create()
    -&gt;directories()
    -&gt;depth(0)
    -&gt;in('vendor/Symfony/Component');

echo "Installed Symfony components:\n";
foreach ($components as $dir) {
    printf("* %s \n", $dir-&gt;getFilename());
}
</code></pre>

<p>To show more sophisticated example, here's how we'd search for files matching the <em>/^He.+Command.php$/</em> pattern, which are smaller than <em>4kb</em> and were modified <em>till yesterday</em>. Results will be sorted by <em>file name</em> and we'll look for them in the <em>current directory</em>:</p>

<pre><code class="php">&lt;?php
// finder.php
require_once __DIR__.'/src/autoload.php';

use Symfony\Component\Finder as Finder;

$files = Finder\Finder::create()
    -&gt;files()
    -&gt;name('/^He.+Command.php$/')
    -&gt;size('&lt;4k')
    -&gt;date('until yesterday')
    -&gt;sortByName()
    -&gt;in('.');

echo "Command files starting with 'He' below 4k modified untill yesterday:\n";
foreach ($files as $file) {
    printf("* %s %s\n", $file-&gt;getFilename(), date('Y-m-d H:i', $file-&gt;getMTime()));
}
</code></pre>

<p>Easy, isn't it?</p>

<p>Finder component gives us a really nice and flexible way to search and than to iterate through files and directories. It's one of those handy libraries which we probably won't use often. Once we need it, however, we may find it a real time saver.</p>
</section>
    </section>


        <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'zalas';
        var disqus_identifier = 'finding-files-and-directories-in-php-with-symfony2-finder-component';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
            </div>
        </div>
                                <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-607315-8', 'auto');
                ga('send', 'pageview');
            </script>
            
            
            <script src="//zalas.eu/components/highlightjs/highlight.pack.js"></script>
            <script>hljs.initHighlightingOnLoad();</script>
                    </body>
</html>
