language: php

php:
  - 7.0

sudo: false

cache:
  directories:
    - "$HOME/.composer/cache"

branches:
  only:
    - source

before_install:
  - echo -e "machine github.com\n  login $GH_TOKEN" >> ~/.netrc

before_script:
  - composer install --prefer-dist

script:
  - sh build.sh

after_success:
  - test $TRAVIS_PULL_REQUEST == "false" && sh publish.sh

env:
  global:
    - secure: Tljn8f36ZD326oETpbASPK8vFjNqIqjm72EAe23N8LHVc9xYUMy6E+rXNUOCNLAI4yPjESkZQ5UfO1aAelHCt1HkCa7r/n68CaczLmAGSz7XNY+WjRnv4JAtQl6AutZRBNHDiPzox9CXY88COJiaztEYmGcyAEZeAvNggCGwjMk=
